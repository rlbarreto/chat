<!DOCTYPE html>
<html>
    <head>
        <% include partials/header.ejs %>
    </head>

    <body ng-app="chatroom">

        <div class="container" ng-controller="mainController as main" ng-show="main.ready">

            <div class="row">
                <div class="col-md-12" ng-hide="main.gotNickname">
                    <form ng-submit="main.nicknameSubmitHandler(main.nickname.trim(), main.password)">
                        <input type="text"
                            class="form-control center-text"
                            ng-model="main.nickname"
                            placeholder="Enter your nickname"
                            autocomplete="off"
                            required
                            autofocus
                        >
                        <input type="password"
                            class="form-control center-text"
                            ng-model="main.password"
                            placeholder="Enter your nickname"
                            autocomplete="off"
                            required
                            autofocus
                        >
                        <input type="submit" value="send">
                    </form>
                </div>
            </div>

            <div class="row">
                <div class="col-md-2" id="chattersContainer" ng-show="main.gotNickname">
                    <ul id="chatters">
                        <li ng-repeat="nickname in main.nicknames" ng-click="main.newChatRoom(nickname)">{{nickname.nickname}}</li>
                    </ul>
                </div>

                <div class="col-md-10" ng-show="main.gotNickname">
                    <ul id="chatters">
                        <li ng-repeat="room in main.rooms" ng-click="main.visibleRoom.visible = false; main.visibleRoom = room; room.visible = true;">{{room.name}}</li>
                    </ul>
                    <div ng-repeat="room in main.rooms">
                        <div ng-show="room.visible">
                            <div ng-repeat="message in room.messages">
                                 <label>{{::message.from}}</label> {{::message.text}}
                            </div>
                            <ng-form ng-submit="main.submitHandler(room)">
                                <input type="text"
                                    id="chatInput"
                                    class="form-control"
                                    ng-model="room.chatInput"
                                    placeholder="Enter your message"
                                    autocomplete="off"
                                    required
                                    autofocus
                                >
                                <input type="button" value="Send" ng-click="main.submitHandler(room)">
                            </form>
                        </div>
                    </div>


                </div>
            </div>

        </div>

        <% include partials/scripts.ejs %>
    </body>
</html>
